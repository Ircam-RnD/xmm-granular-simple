!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var o;o="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,o.xmmClient=e()}}(function(){return function e(o,t,i){function n(s,a){if(!t[s]){if(!o[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=t[s]={exports:{}};o[s][0].call(d.exports,function(e){var t=o[s][1][e];return n(t?t:e)},d,d.exports,e,o,t,i)}return t[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)n(i[s]);return n}({1:[function(e,o,t){"use strict";function i(e){if(e&&e.__esModule)return e;var o={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(o[t]=e[t]);return o.default=e,o}function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=e("babel-runtime/core-js/json/stringify"),s=n(r),a=e("babel-runtime/helpers/classCallCheck"),l=n(a),u=e("babel-runtime/helpers/createClass"),d=n(u),_=e("../utils/gmm-utils"),m=i(_),h=function(){function e(){var o=arguments.length<=0||void 0===arguments[0]?1:arguments[0];(0,l.default)(this,e),this._model=void 0,this._modelResults=void 0,this._likelihoodWindow=o}return(0,d.default)(e,[{key:"filter",value:function(e,o){var t=null,i=null;if(void 0===this._model)return void console.log("no model loaded");try{m.gmmFilter(e,this._model,this._modelResults);var n=this._modelResults.likeliest>-1?this._model.models[this._modelResults.likeliest].label:"unknown",r=this._modelResults.smoothed_normalized_likelihoods.slice(0);i={likeliest:n,likeliestIndex:this._modelResults.likeliest,likelihoods:r},this._model.shared_parameters.bimodal&&(i.outputValues=this._modelResults.output_values.slice(0),i.outputCovariance=this.modelResults.output_covariance.slice(0))}catch(e){t="problem occured during filtering : "+e}o(t,i)}},{key:"_setModel",value:function(e){if(this._model=void 0,this._modelResults=void 0,void 0!==e.models){this._model=e;var o=this._model,t=o.models.length;this._modelResults={instant_likelihoods:new Array(t),smoothed_log_likelihoods:new Array(t),smoothed_likelihoods:new Array(t),instant_normalized_likelihoods:new Array(t),smoothed_normalized_likelihoods:new Array(t),likeliest:-1,singleClassGmmModelResults:[]};var i=o.shared_parameters,n=i.dimension-i.dimension_input;this._modelResults.output_values=new Array(n);for(var r=0;r<n;r++)this._modelResults.output_values[r]=0;var s=void 0;s=0==o.configuration.default_parameters.covariance_mode?n*n:n,this._modelResults.output_covariance=new Array(s);for(var a=0;a<n;a++)this._modelResults.output_covariance[a]=0;for(var l=0;l<t;l++){this._modelResults.instant_likelihoods[l]=0,this._modelResults.smoothed_log_likelihoods[l]=0,this._modelResults.smoothed_likelihoods[l]=0,this._modelResults.instant_normalized_likelihoods[l]=0,this._modelResults.smoothed_normalized_likelihoods[l]=0;var u={instant_likelihood:0,log_likelihood:0};u.likelihood_buffer=new Array(this._likelihoodWindow);for(var d=0;d<this._likelihoodWindow;d++)u.likelihood_buffer[d]=1/this._likelihoodWindow;u.likelihood_buffer_index=0,u.beta=new Array(o.models[l].components.length);for(var _=0;_<u.beta.length;_++)u.beta[_]=1/u.beta.length;u.output_values=this._modelResults.output_values.slice(0),u.output_covariance=this._modelResults.output_covariance.slice(0),this._modelResults.singleClassGmmModelResults.push(u)}}}},{key:"likelihoodWindow",get:function(){return this._likelihoodWindow},set:function(e){if(this._likelihoodWindow=e,void 0!==this._model)for(var o=this._modelResults.singleClassModelResults,t=0;t<this._model.models.length;t++){o[t].likelihood_buffer=new Array(this._likelihoodWindow);for(var i=0;i<this._likelihoodWindow;i++)o.likelihood_buffer[i]=1/this._likelihoodWindow}}},{key:"model",get:function(){if(void 0!==this._model)return JSON.fromString((0,s.default)(this._model))},set:function(e){this._setModel(e)}},{key:"likeliestLabel",get:function(){return void 0!==this._modelResults&&this._modelResults.likeliest>-1?this._model.models[this._modelResults.likeliest].label:"unknown"}},{key:"nbClasses",get:function(){return void 0!==this._model?this._model.models.length:0}}]),e}();t.default=h},{"../utils/gmm-utils":5,"babel-runtime/core-js/json/stringify":7,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}],2:[function(e,o,t){"use strict";function i(e){if(e&&e.__esModule)return e;var o={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(o[t]=e[t]);return o.default=e,o}function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=e("babel-runtime/core-js/json/stringify"),s=n(r),a=e("babel-runtime/helpers/classCallCheck"),l=n(a),u=e("babel-runtime/helpers/createClass"),d=n(u),_=e("../utils/hhmm-utils"),m=i(_),h=function(){function e(){var o=arguments.length<=0||void 0===arguments[0]?1:arguments[0];(0,l.default)(this,e),this._likelihoodWindow=o,this._model=void 0,this._modelResults=void 0}return(0,d.default)(e,[{key:"filter",value:function(e,o){var t=null,i=null;if(void 0===this._model)t="no model loaded yet";else try{m.hhmmFilter(e,this._model,this._modelResults);var n=this._modelResults.likeliest>-1?this._model.models[this._modelResults.likeliest].label:"unknown",r=this._modelResults.smoothed_normalized_likelihoods.slice(0);i={likeliest:n,likeliestIndex:this._modelResults.likeliest,likelihoods:r,timeProgressions:new Array(this._model.models.length),alphas:new Array(this._model.models.length)};for(var s=0;s<this._model.models.length;s++)i.timeProgressions[s]=this._modelResults.singleClassHmmModelResults[s].progress,this._model.configuration.default_parameters.hierarchical?i.alphas[s]=this._modelResults.singleClassHmmModelResults[s].alpha_h[0]:i.alphas[s]=this._modelResults.singleClassHmmModelResults[s].alpha[0];this._model.shared_parameters.bimodal&&(i.outputValues=this._modelResults.output_values.slice(0),i.outputCovariance=this._modelResults.output_covariance.slice(0))}catch(e){t="problem occured during filtering : "+e}o(t,i)}},{key:"reset",value:function(){void 0!==this._model&&this._setModel(this._model)}},{key:"_setModel",value:function(e){if(this._model=void 0,this._modelResults=void 0,e&&void 0!==e.models){this._model=e;var o=this._model,t=o.models.length;this._modelResults={instant_likelihoods:new Array(t),smoothed_log_likelihoods:new Array(t),smoothed_likelihoods:new Array(t),instant_normalized_likelihoods:new Array(t),smoothed_normalized_likelihoods:new Array(t),likeliest:-1,frontier_v1:new Array(t),frontier_v2:new Array(t),forward_initialized:!1,singleClassHmmModelResults:[]};var i=o.shared_parameters,n=i.dimension-i.dimension_input;this._modelResults.output_values=new Array(n);for(var r=0;r<n;r++)this._modelResults.output_values[r]=0;var s=void 0;s=0==o.configuration.default_parameters.covariance_mode?n*n:n,this._modelResults.output_covariance=new Array(s);for(var a=0;a<n;a++)this._modelResults.output_covariance[a]=0;for(var l=0;l<t;l++){this._modelResults.instant_likelihoods[l]=0,this._modelResults.smoothed_log_likelihoods[l]=0,this._modelResults.smoothed_likelihoods[l]=0,this._modelResults.instant_normalized_likelihoods[l]=0,this._modelResults.smoothed_normalized_likelihoods[l]=0;for(var u=o.models[l].parameters.states,d=new Array(3),_=0;_<3;_++){d[_]=new Array(u);for(var m=0;m<u;m++)d[_][m]=0}for(var h=new Array(u),c=0;c<u;c++)h[c]=0;for(var f=new Array(this._likelihoodWindow),p=0;p<this._likelihoodWindow;p++)f[p]=0;var v={hierarchical:o.configuration.default_parameters.hierarchical,instant_likelihood:0,log_likelihood:0,likelihood_buffer:f,likelihood_buffer_index:0,progress:0,exit_likelihood:0,exit_ratio:0,likeliest_state:-1,previous_alpha:h.slice(0),alpha:h,alpha_h:d,prior:new Array(u),transition:new Array(u),window_minindex:0,window_maxindex:0,window_normalization_constant:0,forward_initialized:!1,singleClassGmmModelResults:[]};v.output_values=this._modelResults.output_values.slice(0),v.output_covariance=this._modelResults.output_covariance.slice(0);for(var g=0;g<u;g++){var b={instant_likelihood:0,log_likelihood:0};b.beta=new Array(this._model.models[l].parameters.gaussians);for(var k=0;k<b.beta.length;k++)b.beta[k]=1/b.beta.length;b.output_values=v.output_values.slice(0),b.output_covariance=v.output_covariance.slice(0),v.singleClassGmmModelResults.push(b)}this._modelResults.singleClassHmmModelResults.push(v)}}}},{key:"likelihoodWindow",get:function(){return this._likelihoodWindow},set:function(e){if(this._likelihoodWindow=e,void 0!==this._model)for(var o=this._modelResults.singleClassModelResults,t=0;t<this._model.models.length;t++){o[t].likelihood_buffer=new Array(this._likelihoodWindow);for(var i=0;i<this._likelihoodWindow;i++)o.likelihood_buffer[i]=1/this._likelihoodWindow}}},{key:"model",get:function(){if(void 0!==this._model)return JSON.fromString((0,s.default)(this._model))},set:function(e){this._setModel(e)}},{key:"likeliestLabel",get:function(){return void 0!==this._modelResults&&this._modelResults.likeliest>-1?this._model.models[this._modelResults.likeliest].label:"unknown"}},{key:"nbClasses",get:function(){return void 0!==this._model?this._model.models.length:0}}]),e}();t.default=h},{"../utils/hhmm-utils":6,"babel-runtime/core-js/json/stringify":7,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}],3:[function(e,o,t){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=e("./gmm/gmm-decoder");Object.defineProperty(t,"GmmDecoder",{enumerable:!0,get:function(){return i(n).default}});var r=e("./hhmm/hhmm-decoder");Object.defineProperty(t,"HhmmDecoder",{enumerable:!0,get:function(){return i(r).default}});var s=e("./phrase/xmm-phrase");Object.defineProperty(t,"PhraseMaker",{enumerable:!0,get:function(){return i(s).default}})},{"./gmm/gmm-decoder":1,"./hhmm/hhmm-decoder":2,"./phrase/xmm-phrase":4}],4:[function(e,o,t){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=e("babel-runtime/core-js/number/is-integer"),r=i(n),s=e("babel-runtime/core-js/object/assign"),a=i(s),l=e("babel-runtime/helpers/classCallCheck"),u=i(l),d=e("babel-runtime/helpers/createClass"),_=i(d),m=function(){function e(){var o=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];(0,u.default)(this,e);var t={bimodal:!1,dimension:1,dimension_input:0,column_names:[""],label:""};(0,a.default)(t,o),this._config={},this._setConfig(o),this.reset()}return(0,_.default)(e,[{key:"addObservation",value:function(e){if(e.length!==this._config.dimension||"number"==typeof e&&1!==this._config.dimension)throw console.error("error : incoming observation length not matching with dimensions"),"BadVectorSizeException";this._config.bimodal?(this._data_in=this._data_in.concat(e.slice(0,this._config.dimension_input)),this._data_out=this._data_out.concat(e.slice(this._config.dimension_input))):Array.isArray(e)?this._data=this._data.concat(e):this._data.push(e)}},{key:"reset",value:function(){this._data=[],this._data_in=[],this._data_out=[]}},{key:"_setConfig",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];for(var o in e)"bimodal"===o&&"boolean"==typeof e[o]?this._config[o]=e[o]:"dimension"===o&&(0,r.default)(e[o])?this._config[o]=e[o]:"dimension_input"===o&&(0,r.default)(e[o])?this._config[o]=e[o]:"column_names"===o&&Array.isArray(e[o])?this._config[o]=e[o].slice(0):"label"===o&&"string"==typeof e[o]&&(this._config[o]=e[o])}},{key:"config",get:function(){return this._config},set:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this._setConfig(e)}},{key:"phrase",get:function(){return{bimodal:this._config.bimodal,column_names:this._config.column_names,dimension:this._config.dimension,dimension_input:this._config.dimension_input,label:this._config.label,data:this._data.slice(0),data_input:this._data_in.slice(0),data_output:this._data_out.slice(0),length:this._config.bimodal?this._data_in.length/this._config.dimension_input:this._data.length/this._config.dimension}}}]),e}();t.default=m},{"babel-runtime/core-js/number/is-integer":8,"babel-runtime/core-js/object/assign":9,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}],5:[function(e,o,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=t.gmmComponentRegression=function(e,o,t){var i=t.dimension,n=t.dimension_input,r=i-n;if(o=new Array(r),0===t.covariance_mode)for(var s=0;s<r;s++){o[s]=t.mean[n+s];for(var a=0;a<n;a++){for(var l=0,u=0;u<n;u++)l+=t.inverse_covariance_input[a*n+u]*(e[u]-t.mean[u]);o[s]+=t.covariance[(s+n)*i+a]*l}}else for(var d=0;d<r;d++)o[d]=t.covariance[d+n]},n=t.gmmComponentLikelihood=function(e,o){var t=0;if(0===o.covariance_mode)for(var i=0;i<o.dimension;i++){for(var n=0,r=0;r<o.dimension;r++)n+=o.inverse_covariance[i*o.dimension+r]*(e[r]-o.mean[r]);t+=(e[i]-o.mean[i])*n}else for(var s=0;s<o.dimension;s++)t+=o.inverse_covariance[s]*(e[s]-o.mean[s])*(e[s]-o.mean[s]);var a=Math.exp(-.5*t)/Math.sqrt(o.covariance_determinant*Math.pow(2*Math.PI,o.dimension));return(a<1e-180||isNaN(a)||isNaN(Math.abs(a)))&&(a=1e-180),a},r=t.gmmComponentLikelihoodInput=function(e,o){var t=0;if(0===o.covariance_mode)for(var i=0;i<o.dimension_input;i++){for(var n=0,r=0;r<o.dimension_input;r++)n+=o.inverse_covariance_input[i*o.dimension_input+r]*(e[r]-o.mean[r]);t+=(e[i]-o.mean[i])*n}else for(var s=0;s<o.dimension_input;s++)t+=o.inverse_covariance_input[s]*(e[s]-o.mean[s])*(e[s]-o.mean[s]);var a=Math.exp(-.5*t)/Math.sqrt(o.covariance_determinant_input*Math.pow(2*Math.PI,o.dimension_input));return(a<1e-180||isNaN(a)||isNaN(Math.abs(a)))&&(a=1e-180),a},s=t.gmmComponentLikelihoodBimodal=function(e,o,t){var i=t.dimension,n=t.dimension_input,r=i-n,s=0;if(0===t.covariance_mode)for(var a=0;a<i;a++){for(var l=0,u=0;u<t.dimension_input;u++)l+=t.inverse_covariance[a*i+u]*(e[u]-t.mean[u]);for(var d=0;d<r;d++)l+=t.inverse_covariance[a*i+n+d]*(o[d]-t.mean[n+d]);s+=a<n?(e[a]-t.mean[a])*l:(o[a-n]-t.mean[a])*l}else{for(var _=0;_<n;_++)s+=t.inverse_covariance[_]*(e[_]-t.mean[_])*(e[_]-t.mean[_]);for(var m=t.dimension_input;m<t.dimension;m++){var h=(o[m-n]-t.mean[m])*(o[m-n]-t.mean[m]);s+=t.inverse_covariance[m]*h}}var c=Math.exp(-.5*s)/Math.sqrt(t.covariance_determinant*Math.pow(2*Math.PI,t.dimension));return(c<1e-180||isNaN(c)||isNaN(Math.abs(c)))&&(c=1e-180),c},a=(t.gmmRegression=function(e,o,t){var n=o.components[0].dimension,r=o.components[0].dimension_input,s=n-r;t.output_values=new Array(s);for(var a=0;a<s;a++)t.output_values[a]=0;var l=void 0;l=0===o.parameters.covariance_mode?s*s:s,t.output_covariance=new Array(l);for(var u=0;u<l;u++)t.output_covariance[u]=0;for(var d=void 0,_=0;_<o.components.length;_++){i(e,d,o.components[_]);for(var m=t.beta[_]*t.beta[_],h=0;h<s;h++)if(t.output_values[h]+=t.beta[_]*d[h],0===o.parameters.covariance_mode)for(var c=0;c<s;c++){var f=h*s+c;t.output_covariance[f]+=m*o.components[_].output_covariance[f]}else t.output_covariance[h]+=m*o.components[_].output_covariance[h]}},t.gmmObsProb=function e(o,t){var i=arguments.length<=2||void 0===arguments[2]?-1:arguments[2],r=t.mixture_coeffs,s=t.components,a=0;if(i<0)for(var l=0;l<s.length;l++)a+=e(o,t,l);else a=r[i]*n(o,s[i]);return a}),l=t.gmmObsProbInput=function e(o,t){var i=arguments.length<=2||void 0===arguments[2]?-1:arguments[2],n=t.mixture_coeffs,s=t.components,a=0;if(i<0)for(var l=0;l<s.length;l++)a+=e(o,t,l);else a=n[i]*r(o,s[i]);return a},u=t.gmmObsProbBimodal=function e(o,t,i){var n=arguments.length<=3||void 0===arguments[3]?-1:arguments[3],r=i.mixture_coeffs,a=i.components,l=0;if(n<0)for(var u=0;u<a.length;u++)l+=e(o,t,i,u);else l=r[n]*s(o,t,a[n]);return l},d=t.gmmLikelihood=function(e,o,t){for(var i=arguments.length<=3||void 0===arguments[3]?[]:arguments[3],n=o.mixture_coeffs,r=o.components,s=t,d=0,_=0;_<r.length;_++)singleClassGmmModel.components[_].bimodal?0===i.length?s.beta[_]=l(e,o,_):s.beta[_]=u(e,i,o,_):s.beta[_]=a(e,o,_),d+=s.beta[_];for(var m=0;m<n.length;m++)s.beta[m]/=d;return s.instant_likelihood=d,s.likelihood_buffer[s.likelihood_buffer_index]=d,s.likelihood_buffer_index=(s.likelihood_buffer_index+1)%s.likelihood_buffer.length,s.log_likelihood=s.likelihood_buffer.reduce(function(e,o){return e+o},0),s.log_likelihood/=s.likelihood_buffer.length,d};t.gmmFilter=function(e,o,t){for(var i=o.models,n=t,r=0,s=0,a=0,l=0;l<i.length;l++){var u=n.singleClassGmmModelResults[l];n.instant_likelihoods[l]=d(e,i[l],u),n.smoothed_log_likelihoods[l]=u.log_likelihood,n.smoothed_likelihoods[l]=Math.exp(n.smoothed_log_likelihoods[l]),n.instant_normalized_likelihoods[l]=n.instant_likelihoods[l],n.smoothed_normalized_likelihoods[l]=n.smoothed_likelihoods[l],s+=n.instant_normalized_likelihoods[l],a+=n.smoothed_normalized_likelihoods[l],(0==l||n.smoothed_log_likelihoods[l]>r)&&(r=n.smoothed_log_likelihoods[l],n.likeliest=l)}for(var _=0;_<i.length;_++)n.instant_normalized_likelihoods[_]/=s,n.smoothed_normalized_likelihoods[_]/=a;var m=o.shared_parameters,h=o.configuration;if(m.bimodal){var c=m.dimension,f=m.dimension_input,p=c-f;if(0===h.multiClass_regression_estimator)n.output_values=n.singleClassModelResults[n.likeliest].output_values,n.output_covariance=n.singleClassModelResults[n.likeliest].output_covariance;else{n.output_values=new Array(p);for(var v=0;v<p;v++)n.output_values[v]=0;var g=void 0;g=0==h.default_parameters.covariance_mode?p*p:p,n.output_covariance=new Array(g);for(var b=0;b<g;b++)n.output_covariance[b]=0;for(var k=0;k<i.length;k++)for(var y=n.smoothed_normalized_likelihoods[k],w=n.singleClassGmmModelResults[k],x=0;x<p;k++)if(n.output_values[x]+=y*w.output_values[x],0===h.default_parameters.covariance_mode)for(var R=0;R<p;R++){var j=x*p+R;n.output_covariance[j]+=y*w.output_covariance[j]}else n.output_covariance[x]+=y*w.output_covariance[x]}}}},{}],6:[function(e,o,t){"use strict";function i(e){if(e&&e.__esModule)return e;var o={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(o[t]=e[t]);return o.default=e,o}Object.defineProperty(t,"__esModule",{value:!0}),t.hhmmFilter=t.hhmmUpdateResults=t.hhmmForwardUpdate=t.hhmmForwardInit=t.hhmmLikelihoodAlpha=t.hmmFilter=t.hmmUpdateResults=t.hmmUpdateAlphaWindow=t.hmmForwardUpdate=t.hmmForwardInit=t.hmmRegression=void 0;var n=e("./gmm-utils"),r=i(n),s=t.hmmRegression=function(e,o,t){var i=o.states[0].components[0].dimension,n=o.states[0].components[0].dimension_input,s=i-n,a=void 0;a=0===o.states[0].components[0].covariance_mode?s*s:s,t.output_values=new Array(s);for(var l=0;l<s;l++)t.output_values[l]=0;t.output_covariance=new Array(a);for(var u=0;u<a;u++)t.output_covariance[u]=0;if(2===o.parameters.regression_estimator)return r.gmmLikelihood(e,o.states[t.likeliest_state],t.singleClassGmmModelResults[t.likeliest_state]),r.gmmRegression(e,o.states[t.likeliest_state],t.singleClassGmmModelResults[t.likeliest_state]),void(t.output_values=o.states[t.likeliest_state].output_values.slice(0));var d=0==o.parameters.regression_estimator?0:t.window_minindex,_=0==o.parameters.regression_estimator?o.states.length:t.window_maxindex,m=0==o.parameters.regression_estimator?1:t.window_normalization_constant;m<=0&&(m=1);for(var h=d;h<_;h++){r.gmmLikelihood(e,o.states[h],t.singleClassGmmModelResults[h]),r.gmmRegression(e,o.states[h],t.singleClassGmmModelResults[h]);for(var c=t.singleClassGmmModelResults[h].output_values.slice(0),f=0;f<s;f++)if(t.hierarchical)if(t.output_values[f]+=(t.alpha_h[0][h]+t.alpha_h[1][h])*c[f]/m,0===o.parameters.covariance_mode)for(var p=0;p<s;p++)t.output_covariance[f*s+p]+=(t.alpha_h[0][h]+t.alpha_h[1][h])*(t.alpha_h[0][h]+t.alpha_h[1][h])*t.singleClassGmmModelResults[h].output_covariance[f*s+p]/m;else t.output_covariance[f]+=(t.alpha_h[0][h]+t.alpha_h[1][h])*(t.alpha_h[0][h]+t.alpha_h[1][h])*t.singleClassGmmModelResults[h].output_covariance[f]/m;else if(t.output_values[f]+=t.alpha[h]*c[f]/m,0===o.parameters.covariance_mode)for(var v=0;v<s;v++)t.output_covariance[f*s+v]+=t.alpha[h]*t.alpha[h]*t.singleClassGmmModelResults[h].output_covariance[f*s+v]/m;else t.output_covariance[f]+=t.alpha[h]*t.alpha[h]*t.singleClassGmmModelResults.output_covariance[f]/m}},a=t.hmmForwardInit=function(e,o,t){var i=arguments.length<=3||void 0===arguments[3]?[]:arguments[3],n=o.parameters.states,s=0;if(0===o.parameters.transition_mode)for(var a=0;a<n;a++)o.states[a].components[0].bimodal?i.length>0?t.alpha[a]=o.prior[a]*r.gmmObsProbBimodal(e,i,o.states[a]):t.alpha[a]=o.prior[a]*r.gmmObsProbInput(e,o.states[a]):t.alpha[a]=o.prior[a]*r.gmmObsProb(e,o.states[a]),s+=t.alpha[a];else{for(var l=0;l<t.alpha.length;l++)t.alpha[l]=0;o.states[0].components[0].bimodal?i.length>0?t.alpha[0]=r.gmmObsProbBimodal(e,i,o.states[0]):t.alpha[0]=r.gmmObsProbInput(e,o.states[0]):t.alpha[0]=r.gmmObsProb(e,o.states[0]),s+=t.alpha[0]}if(s>0){for(var u=0;u<n;u++)t.alpha[u]/=s;return 1/s}for(var d=0;d<n;d++)t.alpha[d]=1/n;return 1},l=t.hmmForwardUpdate=function(e,o,t){var i=arguments.length<=3||void 0===arguments[3]?[]:arguments[3],n=o.parameters.states,s=0;t.previous_alpha=t.alpha.slice(0);for(var a=0;a<n;a++){if(t.alpha[a]=0,0===o.parameters.transition_mode)for(var l=0;l<n;l++)t.alpha[a]+=t.previous_alpha[l]*t.transition[l*n+a];else t.alpha[a]+=t.previous_alpha[a]*t.transition[2*a],a>0?t.alpha[a]+=t.previous_alpha[a-1]*t.transition[2*(a-1)+1]:t.alpha[0]+=t.previous_alpha[n-1]*t.transition[2*n-1];o.states[a].components[0].bimodal?i.length>0?t.alpha[a]*=r.gmmObsProbBimodal(e,i,o.states[a]):t.alpha[a]*=r.gmmObsProbInput(e,o.states[a]):t.alpha[a]*=r.gmmObsProb(e,o.states[a]),s+=t.alpha[a]}if(s>1e-300){for(var u=0;u<n;u++)t.alpha[u]/=s;return 1/s}return 0},u=t.hmmUpdateAlphaWindow=function(e,o){var t=e.parameters.states;o.likeliest_state=0;var i=void 0;i=e.parameters.hierarchical?o.alpha_h[0][0]+o.alpha_h[1][0]:o.alpha[0];for(var n=1;n<t;n++)e.parameters.hierarchical?o.alpha_h[0][n]+o.alpha_h[1][n]>i&&(i=o.alpha_h[0][n]+o.alpha_h[1][n],o.likeliest_state=n):o.alpha[n]>i&&(i=o.alpha[0],o.likeliest_state=n);o.window_minindex=o.likeliest_state-t/2,o.window_maxindex=o.likeliest_state+t/2,o.window_minindex=o.window_minindex>=0?o.window_minindex:0,o.window_maxindex=o.window_maxindex<=t?o.window_maxindex:t,o.window_normalization_constant=0;for(var r=o.window_minindex;r<o.window_maxindex;r++)o.window_normalization_constant+=o.alpha_h[0][r]+o.alpha_h[1][r]},d=t.hmmUpdateResults=function(e,o){o.likelihood_buffer[o.likelihood_buffer_index]=Math.log(o.instant_likelihood),o.likelihood_buffer_index=(o.likelihood_buffer_index+1)%o.likelihood_buffer.length,o.log_likelihood=0;for(var t=o.likelihood_buffer.length,i=0;i<t;i++)o.log_likelihood+=o.likelihood_buffer[i];o.log_likelihood/=t,o.progress=0;for(var n=o.window_minindex;n<o.window_maxindex;n++)e.parameters.hierarchical?o.progress+=(o.alpha_h[0][n]+o.alpha_h[1][n]+o.alpha_h[2][n])*n/o.window_normalization_constant:o.progress+=o.alpha[n]*n/o.window_normalization_constant;o.progress/=e.parameters.states-1},_=t.hmmFilter=function(e,o,t){var i=0;if(t.forward_initialized)i=l(e,o,t);else{for(var n=0;n<t.likelihood_buffer.length;n++)t.likelihood_buffer[n]=0;i=a(e,o,t),t.forward_initialized=!0}return t.instant_likelihood=1/i,u(o,t),d(o,t),o.states[0].components[0].bimodal&&s(e,o,t),t.instant_likelihood},m=t.hhmmLikelihoodAlpha=function(e,o,t,i){if(e<0)for(var n=0;n<t.models.length;n++){o[n]=0;for(var r=0;r<3;r++)for(var s=0;s<t.models[n].parameters.states;s++)o[n]+=i.singleClassHmmModelResults[n].alpha_h[r][s]}else for(var a=0;a<t.models.length;a++){o[a]=0;for(var l=0;l<t.models[a].parameters.states;l++)o[a]+=i.singleClassHmmModelResults[a].alpha_h[e][l]}},h=t.hhmmForwardInit=function(e,o,t){for(var i=0,n=0;n<o.models.length;n++){for(var s=o.models[n],a=s.parameters.states,l=t.singleClassHmmModelResults[n],u=0;u<3;u++){l.alpha_h[u]=new Array(a);for(var d=0;d<a;d++)l.alpha_h[u][d]=0}if(0==s.parameters.transition_mode)for(var _=0;_<a;_++)o.shared_parameters.bimodal?l.alpha_h[0][_]=s.prior[_]*r.gmmObsProbInput(e,s.states[_]):l.alpha_h[0][_]=s.prior[_]*r.gmmObsProb(e,s.states[_]),l.instant_likelihood+=l.alpha_h[0][_];else l.alpha_h[0][0]=o.prior[n],o.shared_parameters.bimodal?l.alpha_h[0][0]*=r.gmmObsProbInput(e,s.states[0]):l.alpha_h[0][0]*=r.gmmObsProb(e,s.states[0]),l.instant_likelihood=l.alpha_h[0][0];i+=l.instant_likelihood}for(var m=0;m<o.models.length;m++)for(var h=o.models[m].parameters.states,c=0;c<3;c++)for(var f=0;f<h;f++)t.singleClassHmmModelResults[m].alpha_h[c][f]/=i;t.forward_initialized=!0},c=t.hhmmForwardUpdate=function(e,o,t){var i=o.models.length,n=0,s=0,a=void 0;m(1,t.frontier_v1,o,t),m(2,t.frontier_v2,o,t);for(var l=0;l<i;l++){var u=o.models[l],d=u.parameters.states,_=t.singleClassHmmModelResults[l];a=new Array(d);for(var h=0;h<d;h++)a[h]=0;if(0==u.parameters.transition_mode)for(var c=0;c<d;c++){for(var f=0;f<d;f++)a[c]+=u.transition[f*d+c]/(1-u.exitProbabilities[f])*_.alpha_h[0][f];for(var p=0;p<i;p++)a[c]+=u.prior[c]*(t.frontier_v1[p]*o.transition[p][l]+t.frontier_v2[p]*o.prior[l])}else{a[0]=u.transition[0]*_.alpha_h[0][0];for(var v=0;v<i;v++)a[0]+=t.frontier_v1[v]*o.transition[v][l]+t.frontier_v2[v]*o.prior[l];for(var g=1;g<d;g++)a[g]+=u.transition[2*g]/(1-u.exitProbabilities[g])*_.alpha_h[0][g],a[g]+=u.transition[2*(g-1)+1]/(1-u.exitProbabilities[g-1])*_.alpha_h[0][g-1];for(var b=0;b<3;b++)for(var k=0;k<d;k++)_.alpha_h[b][k]=0}_.exit_likelihood=0,_.instant_likelihood=0;for(var y=0;y<d;y++)s=o.shared_parameters.bimodal?r.gmmObsProbInput(e,u.states[y])*a[y]:r.gmmObsProb(e,u.states[y])*a[y],_.alpha_h[2][y]=o.exit_transition[l]*u.exitProbabilities[y]*s,_.alpha_h[1][y]=(1-o.exit_transition[l])*u.exitProbabilities[y]*s,_.alpha_h[0][y]=(1-u.exitProbabilities[y])*s,_.exit_likelihood+=_.alpha_h[1][y]+_.alpha_h[2][y],_.instant_likelihood+=_.alpha_h[0][y]+_.alpha_h[1][y]+_.alpha_h[2][y],n+=s;_.exit_ratio=_.exit_likelihood/_.instant_likelihood}for(var w=0;w<i;w++)for(var x=0;x<3;x++)for(var R=0;R<o.models[w].parameters.states;R++)t.singleClassHmmModelResults[w].alpha_h[x][R]/=n},f=t.hhmmUpdateResults=function(e,o){for(var t=0,i=0,n=0,r=0;r<e.models.length;r++){var s=o.singleClassHmmModelResults[r];o.instant_likelihoods[r]=s.instant_likelihood,o.smoothed_log_likelihoods[r]=s.log_likelihood,o.smoothed_likelihoods[r]=Math.exp(o.smoothed_log_likelihoods[r]),o.instant_normalized_likelihoods[r]=o.instant_likelihoods[r],o.smoothed_normalized_likelihoods[r]=o.smoothed_likelihoods[r],i+=o.instant_normalized_likelihoods[r],n+=o.smoothed_normalized_likelihoods[r],(0==r||o.smoothed_log_likelihoods[r]>t)&&(t=o.smoothed_log_likelihoods[r],o.likeliest=r)}for(var a=0;a<e.models.length;a++)o.instant_normalized_likelihoods[a]/=i,o.smoothed_normalized_likelihoods[a]/=n};t.hhmmFilter=function(e,o,t){if(o.configuration.default_parameters.hierarchical)t.forward_initialized?c(e,o,t):h(e,o,t);else for(var i=0;i<o.models.length;i++)t.instant_likelihoods[i]=_(e,o,t);for(var n=0;n<o.models.length;n++)u(o.models[n],t.singleClassHmmModelResults[n]),d(o.models[n],t.singleClassHmmModelResults[n]);if(f(o,t),o.shared_parameters.bimodal){for(var r=o.shared_parameters.dimension,a=o.shared_parameters.dimension_input,l=r-a,m=0;m<o.models.length;m++)s(e,o.models[m],t.singleClassHmmModelResults[m]);if(0===o.configuration.multiClass_regression_estimator)t.output_values=t.singleClassHmmModelResults[t.likeliest].output_values.slice(0),t.output_covariance=t.singleClassHmmModelResults[t.likeliest].output_covariance.slice(0);else{for(var p=0;p<t.output_values.length;p++)t.output_values[p]=0;for(var v=0;v<t.output_covariance.length;v++)t.output_covariance[v]=0;for(var g=0;g<o.models.length;g++)for(var b=0;b<l;b++)if(t.output_values[b]+=t.smoothed_normalized_likelihoods[g]*t.singleClassHmmModelResults[g].output_values[b],0===o.configuration.covariance_mode)for(var k=0;k<l;k++)t.output_covariance[b*l+k]+=t.smoothed_normalized_likelihoods[g]*t.singleClassHmmModelResults[g].output_covariance[b*l+k];else t.output_covariance[b]+=t.smoothed_normalized_likelihoods[g]*t.singleClassHmmModelResults[g].output_covariance[b]}}}},{"./gmm-utils":5}],7:[function(e,o,t){o.exports={default:e("core-js/library/fn/json/stringify"),__esModule:!0}},{"core-js/library/fn/json/stringify":13}],8:[function(e,o,t){o.exports={default:e("core-js/library/fn/number/is-integer"),__esModule:!0}},{"core-js/library/fn/number/is-integer":14}],9:[function(e,o,t){o.exports={default:e("core-js/library/fn/object/assign"),__esModule:!0}},{"core-js/library/fn/object/assign":15}],10:[function(e,o,t){o.exports={default:e("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":16}],11:[function(e,o,t){"use strict";t.__esModule=!0,t.default=function(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}},{}],12:[function(e,o,t){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var n=e("../core-js/object/define-property"),r=i(n);t.default=function(){function e(e,o){for(var t=0;t<o.length;t++){var i=o[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(e,i.key,i)}}return function(o,t,i){return t&&e(o.prototype,t),i&&e(o,i),o}}()},{"../core-js/object/define-property":10}],13:[function(e,o,t){var i=e("../../modules/_core"),n=i.JSON||(i.JSON={stringify:JSON.stringify});o.exports=function(e){return n.stringify.apply(n,arguments)}},{"../../modules/_core":21}],14:[function(e,o,t){e("../../modules/es6.number.is-integer"),o.exports=e("../../modules/_core").Number.isInteger},{"../../modules/_core":21,"../../modules/es6.number.is-integer":52}],15:[function(e,o,t){e("../../modules/es6.object.assign"),o.exports=e("../../modules/_core").Object.assign},{"../../modules/_core":21,"../../modules/es6.object.assign":53}],16:[function(e,o,t){e("../../modules/es6.object.define-property");var i=e("../../modules/_core").Object;o.exports=function(e,o,t){return i.defineProperty(e,o,t)}},{"../../modules/_core":21,"../../modules/es6.object.define-property":54}],17:[function(e,o,t){o.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],18:[function(e,o,t){var i=e("./_is-object");o.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},{"./_is-object":35}],19:[function(e,o,t){var i=e("./_to-iobject"),n=e("./_to-length"),r=e("./_to-index");o.exports=function(e){return function(o,t,s){var a,l=i(o),u=n(l.length),d=r(s,u);if(e&&t!=t){for(;u>d;)if(a=l[d++],a!=a)return!0}else for(;u>d;d++)if((e||d in l)&&l[d]===t)return e||d||0;return!e&&-1}}},{"./_to-index":45,"./_to-iobject":47,"./_to-length":48}],20:[function(e,o,t){var i={}.toString;o.exports=function(e){return i.call(e).slice(8,-1)}},{}],21:[function(e,o,t){var i=o.exports={version:"2.4.0"};"number"==typeof __e&&(__e=i)},{}],22:[function(e,o,t){var i=e("./_a-function");o.exports=function(e,o,t){if(i(e),void 0===o)return e;switch(t){case 1:return function(t){return e.call(o,t)};case 2:return function(t,i){return e.call(o,t,i)};case 3:return function(t,i,n){return e.call(o,t,i,n)}}return function(){return e.apply(o,arguments)}}},{"./_a-function":17}],23:[function(e,o,t){o.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},{}],24:[function(e,o,t){o.exports=!e("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":28}],25:[function(e,o,t){var i=e("./_is-object"),n=e("./_global").document,r=i(n)&&i(n.createElement);o.exports=function(e){return r?n.createElement(e):{}}},{"./_global":29,"./_is-object":35}],26:[function(e,o,t){o.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],27:[function(e,o,t){var i=e("./_global"),n=e("./_core"),r=e("./_ctx"),s=e("./_hide"),a="prototype",l=function(e,o,t){
var u,d,_,m=e&l.F,h=e&l.G,c=e&l.S,f=e&l.P,p=e&l.B,v=e&l.W,g=h?n:n[o]||(n[o]={}),b=g[a],k=h?i:c?i[o]:(i[o]||{})[a];h&&(t=o);for(u in t)d=!m&&k&&void 0!==k[u],d&&u in g||(_=d?k[u]:t[u],g[u]=h&&"function"!=typeof k[u]?t[u]:p&&d?r(_,i):v&&k[u]==_?function(e){var o=function(o,t,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(o);case 2:return new e(o,t)}return new e(o,t,i)}return e.apply(this,arguments)};return o[a]=e[a],o}(_):f&&"function"==typeof _?r(Function.call,_):_,f&&((g.virtual||(g.virtual={}))[u]=_,e&l.R&&b&&!b[u]&&s(b,u,_)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,o.exports=l},{"./_core":21,"./_ctx":22,"./_global":29,"./_hide":31}],28:[function(e,o,t){o.exports=function(e){try{return!!e()}catch(e){return!0}}},{}],29:[function(e,o,t){var i=o.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},{}],30:[function(e,o,t){var i={}.hasOwnProperty;o.exports=function(e,o){return i.call(e,o)}},{}],31:[function(e,o,t){var i=e("./_object-dp"),n=e("./_property-desc");o.exports=e("./_descriptors")?function(e,o,t){return i.f(e,o,n(1,t))}:function(e,o,t){return e[o]=t,e}},{"./_descriptors":24,"./_object-dp":37,"./_property-desc":42}],32:[function(e,o,t){o.exports=!e("./_descriptors")&&!e("./_fails")(function(){return 7!=Object.defineProperty(e("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":24,"./_dom-create":25,"./_fails":28}],33:[function(e,o,t){var i=e("./_cof");o.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},{"./_cof":20}],34:[function(e,o,t){var i=e("./_is-object"),n=Math.floor;o.exports=function(e){return!i(e)&&isFinite(e)&&n(e)===e}},{"./_is-object":35}],35:[function(e,o,t){o.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],36:[function(e,o,t){"use strict";var i=e("./_object-keys"),n=e("./_object-gops"),r=e("./_object-pie"),s=e("./_to-object"),a=e("./_iobject"),l=Object.assign;o.exports=!l||e("./_fails")(function(){var e={},o={},t=Symbol(),i="abcdefghijklmnopqrst";return e[t]=7,i.split("").forEach(function(e){o[e]=e}),7!=l({},e)[t]||Object.keys(l({},o)).join("")!=i})?function(e,o){for(var t=s(e),l=arguments.length,u=1,d=n.f,_=r.f;l>u;)for(var m,h=a(arguments[u++]),c=d?i(h).concat(d(h)):i(h),f=c.length,p=0;f>p;)_.call(h,m=c[p++])&&(t[m]=h[m]);return t}:l},{"./_fails":28,"./_iobject":33,"./_object-gops":38,"./_object-keys":40,"./_object-pie":41,"./_to-object":49}],37:[function(e,o,t){var i=e("./_an-object"),n=e("./_ie8-dom-define"),r=e("./_to-primitive"),s=Object.defineProperty;t.f=e("./_descriptors")?Object.defineProperty:function(e,o,t){if(i(e),o=r(o,!0),i(t),n)try{return s(e,o,t)}catch(e){}if("get"in t||"set"in t)throw TypeError("Accessors not supported!");return"value"in t&&(e[o]=t.value),e}},{"./_an-object":18,"./_descriptors":24,"./_ie8-dom-define":32,"./_to-primitive":50}],38:[function(e,o,t){t.f=Object.getOwnPropertySymbols},{}],39:[function(e,o,t){var i=e("./_has"),n=e("./_to-iobject"),r=e("./_array-includes")(!1),s=e("./_shared-key")("IE_PROTO");o.exports=function(e,o){var t,a=n(e),l=0,u=[];for(t in a)t!=s&&i(a,t)&&u.push(t);for(;o.length>l;)i(a,t=o[l++])&&(~r(u,t)||u.push(t));return u}},{"./_array-includes":19,"./_has":30,"./_shared-key":43,"./_to-iobject":47}],40:[function(e,o,t){var i=e("./_object-keys-internal"),n=e("./_enum-bug-keys");o.exports=Object.keys||function(e){return i(e,n)}},{"./_enum-bug-keys":26,"./_object-keys-internal":39}],41:[function(e,o,t){t.f={}.propertyIsEnumerable},{}],42:[function(e,o,t){o.exports=function(e,o){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:o}}},{}],43:[function(e,o,t){var i=e("./_shared")("keys"),n=e("./_uid");o.exports=function(e){return i[e]||(i[e]=n(e))}},{"./_shared":44,"./_uid":51}],44:[function(e,o,t){var i=e("./_global"),n="__core-js_shared__",r=i[n]||(i[n]={});o.exports=function(e){return r[e]||(r[e]={})}},{"./_global":29}],45:[function(e,o,t){var i=e("./_to-integer"),n=Math.max,r=Math.min;o.exports=function(e,o){return e=i(e),e<0?n(e+o,0):r(e,o)}},{"./_to-integer":46}],46:[function(e,o,t){var i=Math.ceil,n=Math.floor;o.exports=function(e){return isNaN(e=+e)?0:(e>0?n:i)(e)}},{}],47:[function(e,o,t){var i=e("./_iobject"),n=e("./_defined");o.exports=function(e){return i(n(e))}},{"./_defined":23,"./_iobject":33}],48:[function(e,o,t){var i=e("./_to-integer"),n=Math.min;o.exports=function(e){return e>0?n(i(e),9007199254740991):0}},{"./_to-integer":46}],49:[function(e,o,t){var i=e("./_defined");o.exports=function(e){return Object(i(e))}},{"./_defined":23}],50:[function(e,o,t){var i=e("./_is-object");o.exports=function(e,o){if(!i(e))return e;var t,n;if(o&&"function"==typeof(t=e.toString)&&!i(n=t.call(e)))return n;if("function"==typeof(t=e.valueOf)&&!i(n=t.call(e)))return n;if(!o&&"function"==typeof(t=e.toString)&&!i(n=t.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":35}],51:[function(e,o,t){var i=0,n=Math.random();o.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++i+n).toString(36))}},{}],52:[function(e,o,t){var i=e("./_export");i(i.S,"Number",{isInteger:e("./_is-integer")})},{"./_export":27,"./_is-integer":34}],53:[function(e,o,t){var i=e("./_export");i(i.S+i.F,"Object",{assign:e("./_object-assign")})},{"./_export":27,"./_object-assign":36}],54:[function(e,o,t){var i=e("./_export");i(i.S+i.F*!e("./_descriptors"),"Object",{defineProperty:e("./_object-dp").f})},{"./_descriptors":24,"./_export":27,"./_object-dp":37}]},{},[3])(3)});